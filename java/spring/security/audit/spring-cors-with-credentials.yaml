rules:
- id: spring-cors-with-credentials
  message: |
    Cross-Origin Resource Sharing with credentials is enabled. This is a security risk.
  metadata:
    cwe: "CWE-284: Improper Access Control"
    owasp: 'A5 - Broken Access Control'
  severity: WARNING
  languages: [java]
  pattern-either:
    - patterns:
        - pattern: |
            $OBJ.allowCredentials(true)
        - pattern-inside: |
            $RETURN $METHOD(..., CorsRegistry $VAR, ...) {
              ...
            }
    - patterns:
        - pattern-inside: |
            @CrossOrigin(...)
            $RETURN $METHOD(...) { ... }
        - pattern-regex: allowCredentials\s*=\s*"true"
    - patterns:
      - pattern-inside: |
          @CrossOrigin(...)
          class $CLASS { ... }
      - pattern-regex: allowCredentials\s*=\s*"true"

